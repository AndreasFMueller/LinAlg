%
% ek-grundlagen.tex -- Grundlagen zur Theorie der endlichen Körper
%
% (c) 2017 Prof Dr Andreas Mueller, Hochschule Rapperswil
%
\section{Endliche Körper}
Im Unterricht in linearer Algebra werden die Eigenschaften der reellen
Zahlen als Grundlage ohne weitere Diskussion akzeptiert.
Im Analysis-Unterricht wird etwas sorgfältiger analyisiert, was denn
genau für Eigenschaften notwendig sind.
Dabei werden erst die rationalen Zahlen $\mathbb Q$ als die Menge der
Brüche der ganzen Zahlen konstruiert.
In einem zweiten Schritt werden diese unter Verwendung der Ordnungsrelation
(Dedekindsche Schnitte)
oder des Abstandsbegriffs (Topologie, metrischer Raum) zu den reellen
Zahlen $\mathbb R$ vervollständigt.
Der zweite Schritt ist aus der Sicht der linearen Algebra nicht nötig.
Die lineare Algebra könnte auch gänzlich über den rationalen Zahlen
entwickelt werden.
Erst bei der Cholesky-Zerlegung oder beim Eigenwertproblem wird es
nötig, die rationalen Zahlen so zu erweitern, dass Quadratwurzeln
(Cholesky-Zerlegung) oder Nullstellen von Polynomen höheren Grades
gefunden werden können.

Die Analysis nutzt aus, dass die rationalen Zahlen nicht nur eine algebraische
Struktur haben, sondern auch eine Ordnungsstruktur.
Insbesondere ist es für zwei beliebige positive rationale Zahlen
$a$ und $b$ möglich, eine Zahl $N$ anzugeben, so dass $Na>b$.
Man sagt, die rationalen Zahlen bilden einen archimedischen Körper.
Die Ordnungsrelation ist also verträglich mit den Rechenoperationen.
In der Analysis äussert sich das dadurch, dass die Multiplikation mit
einer Zahl eine stetige Abbildung ist.
Für die lineare Algebra ist diese Eigenschaft jedoch bedeutungslos:
in den beiden ersten Kapiteln des Skriptes wird die Ordnungsrelation
kein einziges Mal gebraucht!

In diesem Kapitel soll gezeigt werde, wie man ausgehend von den
ganzen Zahlen $\mathbb Z$ auch andere Körper konstruieren kann,
für die die archimedische Eigenschaft nicht erfüllt ist.
Wir verwenden hier einen axiomatischen Zugang um ganz sicher zu sein,
dass wir die konstruierten Zahlkörper nicht versehentlich mit weiteren
Eigenschaften ausstatten, die nicht benötigt werden.
Erst im letzten Abschnitt über das Eigenwert-Problem werden wir
feststellen, dass hierfür die einfachen Körper erweitert werden
müssen.
Dies geschieht durch hinzufügen von geeigneten neuen Zahlen, den
Quadratwurzeln oder anderen Nullstellen.
Im Falle von $\mathbb R$ waren in $\mathbb R$ bereits alle denkbaren
Quadratwurzeln von positiven Zahlen vorhanden, und sie waren beliebig
nahe an rationalen Zahlen.
Da die endlichen Körper keine Ordnungsrelation haben, und damit auch
keinen (offensichtlichen) Abstandsbegriff, finden wir bereits die
notwendigen Quadratwurzeln ``weit ausserhalb'' des Ausgangskörpers.

%
% Definition eines Körpers und Beispiele
%
\subsection{Körper}
Der Begriff des Körpers fasst die Eigenschaften zusammen, die für
die Skalare in der linearen Algebra benötigt werden.

Eine {\em Gruppe} ist eine Menge $G$ mit einer Verknüpfung, die zwei Elementen
$a,b\in G$ das Element $ab\in G$ zuordnet.
Ausserdem müssen folgen Axiome erfüllt sein:
\begin{enumerate}[label={\bf G.\arabic*},itemsep=0mm]
\item
Die Verknüpfung ist assoziativ, d.~h.~$(ab)c=a(bc)$ für alle $a,b,c\in G$.
\item
Es gibt ein Element $e\in G$ mit der Eigenschaft $eg=ge=g$ für alle $g\in G$,
genant das Neutralelement.
\item
Für jedes Element $g\in G$ gibt es ein Element $g^{-1}\in G$ welches
$gg^{-1}=g^{-1}g=e$.
\end{enumerate}
Eine Gruppe heisst {\em abelsch} wenn $ab=ba$ für alle $a,b\in G$.

Ein {\em Ring} ist eine Menge $R$ mit zwei Verknüpfungen, der Addition
und der Multiplikation, mit folgenden Eigenschaften:
\begin{enumerate}[label={\bf R.\arabic*},itemsep=0mm]
\item $R$ ist bezüglich der Addition eine abelsche Gruppe.
\item Die Multiplikation in $R$ ist assoziativ und hat ein Einselement.
\item Für drei Element $x,y,z\in R$ gilt $(x+y)z=xz+yz$ und
$z(x+y)=zx+zy$.
\end{enumerate}

Die Menge $\mathbb Z$ der ganzen Zahlen trägt die Struktur eines Ringes.
Die Menge der $n\times n$-Matrizen mit Einträgen in $\mathbb Z$ ist ebenfalls
ein Ring.
Ist $R$ ein Ring, dann ist die Menge 
\[
R[X]=\{ a_0+a_1X +a_2X^2+\dots +a_nX^n\,|\,a_i\in R\}
\]
der Polynome in der Variablen $X$ ein Ring.

Ein {\em Körper} ist ein Ring, so dass die Menge der von $0$ verschiedenen
Elemente eine abelsche Gruppe bezüglich der Multiplikation bilden.

Die Menge $\mathbb Q$ der rationalen Zahlen trägt die Struktur eines
Körpers.

%
% Körper gebildet mit Restklassen
%
\subsection{Reste}
Die ganzen Zahlen $\mathbb Z$ bilden einen Ring.
Dies bleibt auch wahr für die Menge der Reste $\mathbb Z/n\mathbb Z$.
Die Restklasse $\llbracket r\rrbracket$ von $r$ ist die Menge
\[
\llbracket
r
\rrbracket
=
\{ z\in\mathbb Z\,|\, z\equiv r\mod n\}
\]
der ganzen Zahlen, die den gleichen Rest bei Teilung durch $n$ haben
wie $r$.
Mit Resten kann man wie gewohnt rechnen:
\begin{align*}
\llbracket a \rrbracket
\pm
\llbracket b \rrbracket
&=
\llbracket a\pm b \rrbracket
\\
\llbracket a \rrbracket
\llbracket b \rrbracket
&=
\llbracket ab \rrbracket
\end{align*}
Im allgemeinen ist die Menge der Reste kein Ring.
Ist nämlich $n=pq$ ein Produkt von Zahlen, dann ist das Produkt der
Restklassen
$\llbracket p\rrbracket$
und
$\llbracket q\rrbracket$
\[
\llbracket p\rrbracket
\llbracket q\rrbracket
=
\llbracket pq\rrbracket
=
\llbracket n\rrbracket
=
\llbracket 0\rrbracket.
\]
Insbesondere ist das Produkt der Restklassen von $p$ und $q$ die
Restklasse von $0$, es ist daher nicht möglich, ein multiplikativ
inverses Element für $\llbracket p \rrbracket$ zu finden.
Ursache für dieses pathologische Verhalten ist natürlich, dass $n=pq$
faktorisierbar ist.
Diese Möglichkeit entfällt, wenn $n$ eine Primzahl ist.
Tatsächlich gilt

\begin{satz}
Wenn $p$ eine Primzahl ist, dann ist der Restklassenring
$\mathbb Z/p\mathbb Z=\mathbb F_p$ ein Körper.
\end{satz}

%
% Charakteristik eines Körpers
%
\subsection{Charakteristik}

%
% Der Frobenius-Automorphismus ist eine zusätzliche Struktur, die nur die
% Körper mit Charaketeristik != 0 haben
%
\subsection{Frobenius-Automorphismus}
Für Körper mit Charakteristik $0$ ist das Potenzieren zwar bezüglich der
Multiplikation ein Homomorphismus:
$
(ab)^k = a^kb^k
$
aber nicht bezüglich der Addition, wo die binomische Formel
\begin{equation}
(a+b)^k
= 
a^k + \binom{k}{1} a^{k-1}b + \binom{k}{2} a^{k-2}b^2
+ \binom{k}{3}a^{k-3}b^3 + \dots + \binom{k}{k-1}ab^{k-1} + b^k
\label{ff:binom}
\end{equation}
gilt.
Man kann zeigen, dass die Binomial-Koeffizienten auf Zeile $k$ durch 
$k$ teilbar sind.
Reduzieren wir die binomische Formel \eqref{ff:binom} mit $k=p$ Modulo $p$,
dann folgt
\begin{align*}
(a+b)^p
&= 
a^p + \binom{p}{1} a^{p-1}b + \binom{p}{2} a^{p-2}b^2
+ \binom{p}{3}a^{p-3}b^3 + \dots + \binom{p}{p-1}ab^{p-1} + b^p
\\
&\equiv
a^p + 0\cdot a^{p-1}b + 0\cdot a^{p-1}b^2
+ 0\cdot a^{p-3}b^3 + \dots + 0\cdot ab^{p-1} + b^p
\quad\mod p
\\
&=
a^p + b^p.
\end{align*}
Im Körper $\mathbb F_p$ ist daher die Abbildung $a\mapsto a^p$
ein Homomorphismus von Körpern.
Er heisst der {\em Frobenius-Automorphismus}.

Speziell gilt auch, dass mehrfache Anwendung des Frobenius-Automorphismus
ebenfalls ein Automorphismus ist.
Die $k$-fache Anwendung des Frobenius-Automorphismus ist nichts anderes
als das erheben in die $p^k$-te Potenz.
Dies bedeutet, dass auch die die meisten Binomial-Koeffizienten zu $p^k$ 
durch $p$ teilbar sind:
\[
\binom{p^k}{l}\equiv 0\quad\mod p
\qquad
0<l<p^k.
\]

\begin{beispiel}[Beispiel: Frobenius-Automorphismus in $\mathbb F_2$]
In $\mathbb F_2$ besagt der Frobenius-Automorphismus, dass das Quadrieren
ein Automorphismus ist.
Da $0^2=0$ und $1^2=1$ ist, ist der Frobenius-Automorphismus in $\mathbb F_2$
die identische Abbildung.
\end{beispiel}

Der kleine Satz von Euler besagt, dass für eine Primzahl $p$ und jede
beliebige ganze Zahl $a$ gilt
\[
a^{p-1}\cong 1\mod p
\qquad\Rightarrow\qquad
a^p\cong a\mod p.
\]
Dies bedeutet, dass der Frobenius-Automorphismus auf dem Körper $\mathbb F_p$
immer wie die Identität wirkt.
Seine Wirkung wird also erst sichtbar, wenn man zu Körpererweiterungen
von $\mathbb F_p$ übergeht.
Im Lichte der Galois-Theorie ist $\mathbb F_p$ ein Fix-Körper
unter der Wirkung des Frobenius-Automorphismus.

\begin{beispiel}[Beispiel: Frobenius-Automorphismus in $\mathbb F_2(\alpha)$]
Wir konstruieren eine Körper-Erweiterung vom Grad zwei über dem Körper
$\mathbb F_2$.
Dazu verwenden betrachten wir das Polynom $m(x)=x^2 + x + 1$.
Wir suchen nach Nullstellen des Polynoms.
Durch Einsetzen von $1$ und $0$ in $m(x)$ kann man erkennen, dass
$m(x)$ keine Nullstellen $x\in\mathbb F_2$ hat.

Man kann dies alternativ auch einsehen, indem man versucht, das Polynom
$m(x)$ in Faktoren zu zerlegen.
Da es nur zwei Polynome ersten Grades gibt, kann man durch durchprobieren
aller Polynome ersten Grades herausfinden, ob $m(x)$ irreduzibel ist.
$m(x)$ ist offensichtlich nicht durch $x$ teilbar.
Andererseits ist $m(x)$ auch nicht durch $x+1$ teilbar, denn da $x$ kein
Faktor sein kann, müsste dann $m(x)=(x+1)^2=x^2 +  2x + 1=x^2+x$ sein,
was offensichtlich nicht zutrifft.
Somit ist $m(x)$ irreduzibel über $\mathbb F_2$.

Wir postulieren jetzt zwei neue ``Zahlen'' $\alpha$ und $\beta$, die
zu $\mathbb F_2$ hinzugefügt werden sollen, und die Nullstellen von 
$m(x)$ sein sollen.
Sie müssen daher die Gleichungen
\[
\left.
\begin{aligned}
\alpha^2 + \alpha +1&=0
\\
\beta^2 + \beta +1&=0
\end{aligned}
\right\}
\qquad\Rightarrow\qquad
\left\{
\begin{aligned}
\alpha^2&=\alpha+1\\
\beta^2&=\beta+1
\end{aligned}
\right.
\]
Die Zahl $\alpha+1$ ist ebenfalls eine Nullstelle von $m(x)$:
\[
m(\alpha+1)
=
(\alpha+1)^2+(\alpha+1) + 1
=
\underbrace{\alpha^2 + 1}_{\text{Frobenius}}\mathstrut + \alpha + 1 + 1
=
\underbrace{\alpha+1}_{\alpha^2} + 1+ (\alpha + 1) + 1=0.
\]
Da $\alpha+1\ne \alpha$ ist, aber auch eine Nullstelle, gibt es nur
noch die eine Möglichkeit, dass $\alpha+1=\beta$ ist.
Dann ist aber auch
\[
\beta^2
=
(\alpha + 1)^2
= 
\alpha^2 + 1
=
\alpha + 1 + 1
=
\alpha.
\]
Der Frobenius-Automorphismus vertauscht die beiden Nullstellen.
In diesem Sinne ist der Frobenius-Automorphismus analog zum
von $i\mapsto -i$ indizierten Automorphismus von
$\mathbb C = \mathbb R(i)$.

Man beachte, dass das hier betrachtet Polynom $m(x)=x^2+x+1$ auch
als Polynom über $\mathbb Q$ irreduzibel ist.
Seine Nullstellen in $\mathbb R$ sind nämlich
\[
x_{\pm}=-\frac12 \pm\frac{\sqrt{3}}{2}i\not\in\mathbb Q.
\]
Man kann aber auch hier nachrechnen, dass 
\begin{align*}
x_+^2
&=
\biggl(-\frac12+\frac{\sqrt{3}}{2}i\biggr)^2
=
\frac14-2\frac{\sqrt{3}}{4}i-\frac34
=
-\frac12-\frac{\sqrt{3}}{2}i
=
-x_+-1,
\\
x_-^2
&=
\biggl(-\frac12-\frac{\sqrt{3}}{2}i\biggr)^2
=
\frac14+2\frac{\sqrt{3}}{4}i-\frac34
=
-\frac12+\frac{\sqrt{3}}{2}i
=
-x_--1
\end{align*}
gilt.

Wir hätten $m(x)=x^2+x+1$ als Polynom über $\mathbb F_2$ aber auch
als die Reduktion $\mod 2$ des Polynoms $q(x)=x^2-x-1$ über $\mathbb Z$
betrachten können, Vorzeichenwechsel sind in $\mathbb F_2$ ja nicht
möglich.
Die Nullstellen von $q(x)$ sind aber
\[
x_{\pm}
=
\frac12\pm\frac{\sqrt{5}}2.
\]
Hier haben wir also ein Polynom, welches über $\mathbb R$ reduzibel ist.
Dies illustriert, dass verschiedene Polynome mit ganzlich unterschiedlicher
Nullstellen das gleiche algebraische Verhalten als Polynome über $\mathbb F_2$
zeigen.
Die Zahlen
\[
-\frac12\pm\frac{\sqrt{3}}{2}i
\qquad\text{und}\qquad
\frac12\pm\frac{\sqrt{5}}{2}
\]
haben also die gleichen algebraischen Eigenschaften wie die beiden Zahlen
$\alpha$ und $\beta$ als Nullstellen von $m(x)$ über $\mathbb F_2$.
\end{beispiel}


