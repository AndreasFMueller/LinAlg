% Lehraufgabe zur QR-Zerlegung
%Q =
%
%  -0.727607  -0.505790   0.463428
%   0.485071  -0.857032  -0.173785
%   0.485071   0.098348   0.868927
%
%R =
%
%  -4.12311  -2.91043   2.66789
%   0.00000   4.18681  -0.29504
%   0.00000   0.00000  -2.60678
%
%octave:10> Q*R
%ans =
%
%   3.0000e+00   8.8818e-16  -3.0000e+00
%  -2.0000e+00  -5.0000e+00   2.0000e+00
%  -2.0000e+00  -1.0000e+00  -1.0000e+00
%
Das Ziel dieser Aufgabe ist zu illustrieren, dass jede beliebige reguläre 
$n\times n$ Matrix $A$ geschrieben werden kann in der Form $A=QR$,
wobei $Q$ eine orthogonale Matrix ist und $R$ eine obere Dreicksmatrix.
Die Berechnungen in dieser Aufgabe werden mit Vorteil nur numerisch mit
dem Taschenrechner durchgeführt.
\begin{teilaufgaben}
\item
Gegeben ist die Matrix 
\[
A=\begin{pmatrix}
 3& 0&-3\\
-2&-5& 2\\
-2&-1&-1
\end{pmatrix}.
\]
Wenden Sie den Gram-Schmidtschen Orthonormalisierungsprozess auf
die Spalten von $A$ an, die neuen Vektoren bilden die Matrix $Q$.
\item
Ist die Matrix $Q$ orthogonal?
Ist das immer so, also nicht nur für diese spezielle Matrix $A$?
\item
Finden Sie eine Matrix $R$ derart, dass $A=QR$.
Was fällt ihnen an der Matrix $R$ auf?
\item 
Im Gram-Schmidt Prozess wurden die Spalten $q_k$ so konstruiert, dass
$a_i$ eine Linearkombination von $q_k$ mit $1\le k\le i$ ist.
Schreiben Sie diese Bedingung für jedes $i$ mit Hilfe von Koeffizienten
$r_{ki}$
\item
Zeigen Sie, dass die Linearkombinationen von Teilaufgabe d) auch
als Matrixprodukt $A=QR$
geschrieben werden kann.
\end{teilaufgaben}

\thema{QR-Zerlegung}

\begin{loesung}
\begin{teilaufgaben}
\item
Das Orthonormalisierungsverfahren liefert 
\begin{align*}
b_1
&=
\frac1{\sqrt{17}} \begin{pmatrix}3\\-2\\-2\end{pmatrix}
=
\begin{pmatrix}
   0.727607\\
  -0.485071\\
  -0.485071
\end{pmatrix}
\\
b_2
&=
\frac{a_2-(a_2\cdot b_1)b_1}{|Z|}
=
\frac{
\begin{pmatrix}0\\-4\\-1\end{pmatrix} - 2.9104\cdot b_1
}{|Z|}
=
\frac{\begin{pmatrix}
  -2.11765\\
  -3.58824\\
   0.41176
\end{pmatrix}}{|Z|}
=
\begin{pmatrix}
  -0.505790\\
  -0.857032\\
   0.098348
\end{pmatrix}
\\
b_3
&=
\frac{a_3-(a_3\cdot b_1)b_1-(a_3\cdot b_2)b_2}{|Z|}
=
\frac{\begin{pmatrix}-3\\2\\-1\end{pmatrix} +2.6679\cdot b_1 +0.29504\cdot b_2}{|Z|}
=
\frac{\begin{pmatrix}
  -1.20805\\
   0.45302\\
  -2.26510
\end{pmatrix}}{|Z|}
\\
&=
\begin{pmatrix}
  -0.46343\\
   0.17379\\
  -0.86893
\end{pmatrix}
\end{align*}
Zusammengefasst in eine Matrix ist dies 
\[
Q=\begin{pmatrix}
   0.727607& -0.505790& -0.463428\\
  -0.485071& -0.857032&  0.173785\\
  -0.485071&  0.098348& -0.868927
\end{pmatrix}.
\]
\item
Durch Ausmultiplizieren erhält man
\[
QQ^t
=
\begin{pmatrix}
   1                  &  4.1633\cdot10^{-17}&-5.5511\cdot10^{-17}\\
   4.1633\cdot10^{-17}&  1                  &-1.1102\cdot10^{-16}\\
  -5.5511\cdot10^{-17}& -1.1102\cdot10^{-16}&  1
\end{pmatrix}.
\]
Die Terme ausserhalb der Diagonalen sind praktisch gleich $0$, sie
sind durch Rundungsfehler entstanden.
\item
Da $Q$ orthogonal ist, ist $Q^{-1}=Q^t$, und wir können $R$ direkt
berechnen:
\[
R=Q^{-1}A=Q^tA=
\begin{pmatrix}
   4.1231             & 2.9104             &-2.6679    \\
  -3.3307\cdot10^{-16}& 4.1868             &-0.29504   \\
   6.6613\cdot10^{-16}&-2.2204\cdot10^{-16}& 2.6068
\end{pmatrix}
\]
Bis auf die wieder durch Rundungsfehler verursachten Terme unter der
Diagonalen ist dies eine rechte obere Dreiecksmatrix.
\item
Es ist
\begin{align*}
a_1 &= r_{11} q_1 \\
a_2 &= r_{12} q_1 + r_{22} q_2 \\
a_3 &= r_{13} q_1 + r_{23} q_2 + r _{33} q_3 \\
    &\phantom{=}\vdots
\end{align*}
\item
Aus der Definition des Matrixproduktes (``$\text{Zeilen}\times\text{Spalten}$'')
liest man ab, dass 
\[
A=Q\begin{pmatrix}
r_{11}&r_{12}&r_{13}&\dots &r_{1n}\\
     0&r_{22}&r_{23}&\dots &r_{2n}\\
     0&     0&r_{33}&\dots &r_{3n}\\
\vdots&\vdots&\vdots&\ddots&\vdots\\
     0&     0&     0&\dots &r_{nn}
\end{pmatrix}.
\]
\end{teilaufgaben}
\end{loesung}

