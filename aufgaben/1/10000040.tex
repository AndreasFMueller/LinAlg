Die Sylvester Gleichung (nach James Joseph Sylvester, 1884) ist die
Gleichung
\begin{equation}
AX+XB=C
\label{10000040:sylvester}
\end{equation}
von $n\times n$-Matrizen.
Gesucht ist $X$ zu gegebenen Matrizen $A$, $B$ und $C$.
Da man für $n>1$ die Faktoren im Allgmeinen nicht vertauschen darf,
ist die Gleichung nicht direkt mit Matrizenalgebra lösbar.
Trotzdem ist es natürlich eine lineare Gleichung für Elemente von $X$.
Für den Fall $n=2$ schreibe man
\begin{equation}
X=\begin{pmatrix}
x_1&x_2\\
x_3&x_4
\end{pmatrix}
\label{10000040:sylvester2}
\end{equation}
und stelle die linearen Gleichungen für $x$ auf.

\thema{Matrizenprodukt}

\begin{loesung}
Auf beiden Seiten der Gleichung (\ref{10000040:sylvester})
stehen $2\times 2$-Matrizen,
die Gleichung stellt also vier Gleichungen bereit, die
vier Einträge der Matrix $X$ zu bestimmen.
Ausmultiplizieren der beiden Matrizenprodukte $AX$ und $XB$ ergibt
\begin{align*}
AX&=\begin{pmatrix}
a_{11}x_1+a_{12}x_3&
a_{11}x_2+a_{12}x_4\\
a_{21}x_1+a_{22}x_3&
a_{21}x_2+a_{22}x_4
\end{pmatrix}
&&\text{und}
&
XB&=
\begin{pmatrix}
x_1b_{11}+x_2b_{21}&
x_1b_{12}+x_2b_{22}\\
x_3b_{11}+x_4b_{21}&
x_3b_{12}+x_4b_{22}
\end{pmatrix}.
\end{align*}
Man kann jetzt die Gleichungen als lineares Gleichungssystem für die
Variablen $x_1,\dots,x_4$ aufschreiben:
\begin{equation}
\begin{linsys}{5}
(a_{11}+b_{11})x_1&+&        b_{21}\phantom{)} x_2&+&        a_{12}\phantom{)} x_3& &                  &=&c_{11}\\
        b_{12}\phantom{)} x_1&+&(a_{11}+b_{22})x_2& &                  &+&        a_{12}\phantom{)} x_4&=&c_{12}\\
        a_{21}\phantom{)} x_1& &                  &+&(a_{22}+b_{11})x_3&+&        b_{21}\phantom{)} x_4&=&c_{21}\\
                  & &        a_{21}\phantom{)} x_2&+&        b_{22}\phantom{)} x_3&+&(a_{22}+b_{12})x_4&=&c_{22}
\end{linsys}
\label{10000040:glsystem}
\end{equation}
Die Koeffizientenmatrix dieses Gleichungssystems ist
\begin{align}
\begin{pmatrix}
a_{11}+b_{11}&       b_{21}&a_{21}       &            0\\
       b_{12}&a_{11}+b_{22}&            0&       a_{12}\\
a_{21}       &            0&a_{22}+b_{11}&       b_{21}\\
            0&a_{21}       &       b_{22}&a_{22}+b_{12}
\end{pmatrix}
&=
\begin{pmatrix}
a_{11}&     0&a_{21}&     0\\
     0&a_{11}&     0&a_{21}\\
a_{21}&     0&a_{22}&     0\\
     0&a_{21}&     0&a_{22}
\end{pmatrix}
+
\begin{pmatrix}
b_{11}&b_{21}&     0&     0\\
b_{12}&b_{22}&     0&     0\\
     0&     0&b_{11}&b_{21}\\
     0&     0&b_{12}&b_{22}
\end{pmatrix}
\notag
\\
&=
\begin{pmatrix}
a_{11}E&a_{12}E\\
a_{21}E&a_{22}E
\end{pmatrix}
+
\begin{pmatrix}
B^t&0\\
0&B^t
\end{pmatrix}.
\label{10000040:matrix}
\end{align}
Damit ist die Lösung der Sylvester-Gleichung (\ref{10000040:sylvester}) auf 
die Lösung eines linearen Gleichungssystems mit 4 Unbekannten und 4 Gleichungen
zurückgeführt.

Um einzusehen, dass die Gleichung ein lineares Gleichungssystem für $X$ ist,
könnte man auch wie folgt vorgehen.
Die linke Seite ist linear in $X$, wenn gilt
\begin{align*}
A(X_1+X_2)+(X_1+X_2)B&=AX_1+AX_2+X_1B+X_2B=AX_1+X_1B + AX_2+X_2B\\
A(\lambda X)+(\lambda X)B&=\lambda AX+\lambda XB=\lambda(AX+XB)
\end{align*}
welche beide aus den Rechenregeln der Matrizenalgebra unmittelbar folgen.
\end{loesung}

\begin{diskussion}
Die Lösung der Sylvester-Gleichung auf diesem Weg ist sehr aufwendig und
numerisch auch nicht stabil. 
Für beliebiges $n$ hat das Gleichungssystem für die Unbekannten $x_i$ 
nicht weniger als $n^2$ Unbekannte.
Die Lösung mit dem Gauss-Algorithmus braucht dafür $O(n^6)$ Operationen.
Es stehen alternative Algorithmen zur Verfügung, die die Sylvester-Gleichung
mit Aufwand $O(n^3)$ lösen können.

Die Matrix (\ref{10000040:matrix}) hat eine sehr spezielle Form.
Mit dem sogenannten Kronecker-Produkt kann man sie in der Form
\[
\begin{pmatrix}
a_{11}E&a_{12}E\\
a_{21}E&a_{22}E
\end{pmatrix}
+
\begin{pmatrix}
B^t&0\\
0&B^t
\end{pmatrix}
=
E_n \otimes A
+
B^t \otimes E_n
\]
schreiben.

Um das Gleichungssystem aufzustellen, wurde $X$ als ein Vektor betrachtet.
Schreibt man $\operatorname{vec}X$ für den aus der Matrix $X$ in dieser Art
gewonnenen Vektor, dann kann das der Sylvester-Gleichung äquivalente
lineare Gleichungssystem (\ref{10000040:glsystem}) kompakt als
\[
(E_n \otimes A
+
B^t \otimes E_n)\operatorname{vec}X
=
\operatorname{vec}C
\]
geschrieben werden.
\end{diskussion}


